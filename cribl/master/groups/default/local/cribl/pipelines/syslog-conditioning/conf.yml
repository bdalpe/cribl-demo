asyncFuncTimeout: 1000
output: default
description: Set default fields
functions:
  - id: eval
    filter: "true"
    disabled: null
    conf:
      add:
        - name: index
          value: "index ? index : 'cribl'"
        - name: source
          value: "source ? source : appname"
        - name: sourcetype
          value: "sourcetype ? sourcetype : 'nagios'"
      remove: []
  - id: serde
    filter: "true"
    disabled: null
    conf:
      mode: extract
      srcField: structuredData
      type: kvp
  - id: eval
    filter: message
    disabled: false
    conf:
      add:
        - name: _raw
          value: message
  - id: eval
    filter: "true"
    disabled: false
    conf:
      add:
        - name: index
          value: "index ? index : 'cribl'"
        - name: source
          value: "source ? source : appname"
        - name: sourcetype
          value: "sourcetype ? sourcetype : 'nagios'"
      remove:
        - facility
        - severity
        - message
groups: {}
